<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Work in progress</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="WorkInProgress.css" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>
    <div class="row">
      <!-- Sidebar -->
      <nav id="sidebar" class="col-lg-2 bg-dark d-lg-block position-sticky">
        <div class="hamburger-button">
          <button class="btn btn-dark d-lg-none" id="sidebar-toggle-button">
            &#9776;
          </button>
        </div>
        <div class="sidebar-content">Sidebar</div>
      </nav>
      <!-- Sidebar ending -->

      <div class="col-6 text-center mt-5 m-2">
        <div class="row">
          <div class="col mt-3">
            <!-- For image -->
            <img
              height="200px"
              width="200px"
              id="profile"
              class="rounded-circle shadow-4-strong"
              alt="profile"
              src="imgs\profile.png"
            />
          </div>
        </div>
        <!-- Image ending -->

        <div class="row mt-3 text-success fs-3">
          <div class="text-center">
            <i class="fas fa-briefcase me-1"></i>
            <span id="work-type-text">Work in progress</span>
            <!-- Add id attribute -->
          </div>
        </div>

        <!-- "To begin text start" -->
        <div class="row mt-3">
          <span
            >To stop your work time, simply click the "Stop work" button.</span
          >
        </div>
        <!-- "To begin text ending" -->

        <!-- "Stopwatch timer start" -->
        <div class="row mt-3 text-center">
          <div class="col">
            <div id="timer" class="display-2">00:00:00</div>

            <button id="stopButton" class="btn btn-danger mt-4">Stop</button>
          </div>
        </div>

        <!-- "Stopwatch timer ending" -->

        <!-- Log entries -->
        <div class="container mt-2">
          <div class="row">
            <div
              class="col-xl-8 col-lg-8 col-md-8 col-sm-12 offset-md-2 mt-5 mb-5"
            >
              <div class="card mt-5">
                <div class="card-header">Log Entries</div>
                <div class="card-body">
                  <div class="log d-flex flex-wrap"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col m-5">
        <div class="row">
          <div class="form-floating mt-5">
            <textarea
              class="form-control"
              placeholder="Leave a comment here"
              id="floatingTextarea2"
              style="height: 650px"
            ></textarea>
            <label for="floatingTextarea2 "></label>
          </div>
        </div>
      </div>
    </div>
    <script>
      $(document).ready(function () {
        // Extract the selected hours and work type from the URL
        var urlParams = new URLSearchParams(window.location.search);
        var selectedHours = urlParams.get("hours");
        var selectedWorkType = urlParams.get("work_type");

        if (selectedHours) {
          // Convert the selected hours to milliseconds
          var countdownTime = selectedHours * 60 * 60 * 1000; // hours * minutes * seconds * milliseconds

          // Update the countdown timer every second
          var timerElement = document.getElementById("timer");

          function updateTimer() {
            countdownTime -= 1000; // Subtract 1 second
            if (countdownTime <= 0) {
              // Timer has reached 0, you can perform an action here
              timerElement.innerHTML = "Time's up!";
            } else {
              // Format the remaining time as HH:MM:SS
              var hours = Math.floor(countdownTime / 3600000);
              var minutes = Math.floor((countdownTime % 3600000) / 60000);
              var seconds = Math.floor((countdownTime % 60000) / 1000);
              timerElement.innerHTML = hours + ":" + minutes + ":" + seconds;
            }
          }

          // Call updateTimer every second
          setInterval(updateTimer, 1000);
        }

        // Display log entries
        var logContainer = document.querySelector(".log");

        if (selectedWorkType) {
          var timestamp = new Date().toLocaleString();
          var logEntryText = selectedWorkType + " started at " + timestamp;

          var logEntry = document.createElement("p");
          logEntry.textContent = logEntryText;
          logContainer.appendChild(logEntry);

          // Update the work type text
          var workTypeText = document.getElementById("work-type-text");
          workTypeText.textContent = selectedWorkType + " in progress";
        }
      });
    </script>
  </body>
</html>
